
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples\HeterogeneousFields\plot_localdeformfield.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_HeterogeneousFields_plot_localdeformfield.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_HeterogeneousFields_plot_localdeformfield.py:


=============================================
Heterogeneous textures from local deformation
=============================================

.. codeauthor:: Frédéric Richard <frederic.richard_at_univ-amu.fr>

In this example, we show how to simulate
heterogeneous textures by applying a local deformation
to an :term:`isotropic<isotropy>` random field.

Given a fractional Brownian field :math:`X`, the transformed field
is defined by composition

.. math::
    Y = X \circ T,

of :math:`X` with a transformation :math:`T` mapping :math:`(x, y)`
into :math:`(x^{1.5}, y)`.

The heterogeneous texture is obtained by simulation of :math:`Y`.

.. note::
    Such an approach can only be applied if the transformed coordinates
    remain integer.

.. GENERATED FROM PYTHON SOURCE LINES 66-92



.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /auto_examples/HeterogeneousFields/images/sphx_glr_plot_localdeformfield_001.png
          :alt: Simulation of the deformed field.
          :class: sphx-glr-multi-img

    *

      .. image:: /auto_examples/HeterogeneousFields/images/sphx_glr_plot_localdeformfield_002.png
          :alt: Simulation of the undeformed field.
          :class: sphx-glr-multi-img





.. code-block:: default

    import numpy as np
    from afbf import coordinates, tbfield

    # Define a fractional Brownian field.
    X = tbfield()
    # Define an affine transform.
    T = np.array([[1, 0], [2, 1]], dtype=int)

    # Define a uniform grid.
    coord = coordinates(256)
    # Simulate the field without transformation.
    n0 = int(np.random.randn())
    np.random.seed(1)
    y0 = X.Simulate()

    # Apply a local transform to the the grid.
    coord.xy[:, 0] = np.power(coord.xy[:, 0], 1.5)
    # Simulate the field with transformation (with a same seed).
    y = X.Simulate(coord)

    # Display of simulations.
    y.name = 'Simulation of the deformed field.'
    y.Display(1)

    y0.name = 'Simulation of the undeformed field.'
    y0.Display(2)


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  52.423 seconds)


.. _sphx_glr_download_auto_examples_HeterogeneousFields_plot_localdeformfield.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_localdeformfield.py <plot_localdeformfield.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_localdeformfield.ipynb <plot_localdeformfield.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
