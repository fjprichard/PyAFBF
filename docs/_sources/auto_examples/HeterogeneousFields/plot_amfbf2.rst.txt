
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples\HeterogeneousFields\plot_amfbf2.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_HeterogeneousFields_plot_amfbf2.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_HeterogeneousFields_plot_amfbf2.py:


============================================
Anisotropic Multifractional Brownian field 2
============================================

.. codeauthor:: Frédéric Richard <frederic.richard_at_univ-amu.fr>

In this example, we show how to simulate heterogeneous textures whose
anisotropy spatially varies. Such textures can be obtained
by simulating a turning band field with a space-dependent Hurst function
represented as a step function.

Here, the Hurst function :math:`\beta_{(x,y)}` is defined at position
:math:`(x, y)` by changing linearly a Hurst constant. The directional
properties of the generated texture vary in the vertical direction from
anisotropic to isotropic while its roughness remains the same.

.. note::
  Such simulations are related to the so-called
  **anisotropic multifractional Brownian field**
  which was investigated :cite:p:`Vu2020`. In a harmonizable
  representation, these fields are defined as

  .. math::
      Z(x, y) = \int_{\mathbb{R}^2}
      (e^{i\langle (x, y), w \rangle} -1 ) \tau_{(x, y)}(w)
      \vert w \vert^{-\beta_{x, y}(w) -1}
      dW(w),

  where :math:`dW` stands for a complex Brownian measure.

.. GENERATED FROM PYTHON SOURCE LINES 71-131



.. image:: /auto_examples/HeterogeneousFields/images/sphx_glr_plot_amfbf2_001.png
    :alt: Anisotropic Multifractional Brownian field
    :class: sphx-glr-single-img





.. code-block:: default


    import numpy as np
    from afbf import coordinates, sdata, tbfield

    N = 256  # Image size.

    pid = np.pi / 5  # length of a step of the Hurst function.
    dpid = np.pi / 16  # length of the transition between steps.

    h0 = 0.1  # Hurst index at (x, y) with y=0.
    h1 = 0.9  # Hurst index at (x, y) with y=N-1.

    pid = np.pi / 16  # length of a step of the Hurst function.
    dpid = np.pi / 6  # length of the transition between steps.
    h0 = 0.1
    h1 = 0.9

    # Define a field.
    Z = tbfield('afbf-smooth')
    # Set step interval bounds.
    Z.hurst.ChangeParameters(
            np.array([[h1, h0]]),
            np.array([[-pid - dpid, -pid, pid, pid + dpid]])
        )
    Z.hurst.trans = 1  # Indicate where step transitions are.

    # Set coordinates.
    coord = coordinates(N)  # field coordinates.
    coordy = coordinates()  # subset of coordinates.
    x = np.reshape(np.arange(1, N+1), (N, 1))

    # Initialize an image.
    z = sdata(coord)
    z.name = 'Anisotropic Multifractional Brownian field'

    for y in range(N):
        # Rescale the Hurst function.
        t = y / (N - 1)
        h = h0 * t + h1 * (1 - t)
        # Change the step constants.
        Z.hurst.ChangeParameters(
            np.array([h, h0])
        )
        # Normalization.
        Z.NormalizeModel()

        # Restrict to coordinates (:, y).
        coordy.DefineNonUniformLocations(
            np.concatenate((x, (y+1) * np.ones((N, 1))), axis=1))
        coordy.N = coord.N

        # Simulate the current field keeping a same random seed.
        np.random.seed(1)
        zy = Z.Simulate(coordy)

        # Keep the simulation at positions  (y:-1, :).
        z.values.reshape(N, N)[y, :] = zy.values.reshape(1, N)[0, 0:N]

    # Display the simulation.
    z.Display()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 8 minutes  49.510 seconds)


.. _sphx_glr_download_auto_examples_HeterogeneousFields_plot_amfbf2.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_amfbf2.py <plot_amfbf2.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_amfbf2.ipynb <plot_amfbf2.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
