<table style="width:6%;">
<colgroup>
<col style="width: 5%" />
</colgroup>
<tbody>
<tr class="odd">
<td>title: ‚Äò<strong>PyAFBF</strong>: a Python library for sampling image textures from the anisotropic fractional Brownian field.‚Äô tags:</td>
</tr>
<tr class="even">
<td>- Python - mathematics - texture synthesis - image processing - probability - statistics - fractional Brownian field</td>
</tr>
<tr class="odd">
<td>authors:</td>
</tr>
<tr class="even">
<td>- name: Fr√©d√©ric J.P. Richard orcid: 0000-0001-5146-9894 affiliation: 1</td>
</tr>
<tr class="odd">
<td>affiliations:</td>
</tr>
<tr class="even">
<td>- name: Aix Marseille University, CNRS, Centrale Marseille, I2M, UMR 7373, Marseille, France. index: 1 date: 18 may 2021 bibliography: refs.bib</td>
</tr>
</tbody>
</table>
<h1 id="summary">Summary</h1>
<p>The Python library <strong>PyAFBF</strong> is devoted to the simulation of anisotropic textures of image. These textures are sampled from a mathematical model called the anisotropic fractional Brownian field (AFBF) <span class="citation" data-cites="Bonami2003">[@Bonami2003]</span>; see Figure  for an illustration. The library offers several features. It enables to set, either manually or randomly, the simulated model so as to generate a wide variety of textures. It also include tools to compute model features (regularity, anisotropy,‚Ä¶) which may serve as attributes to describe generated textures. The library further offers the possibility to sample heterogeneous textures from random field models related to the AFBF.</p>
<figure>
<img src="patchwork.png" alt="A patchwork of simulated textures. " /><figcaption aria-hidden="true">A patchwork of simulated textures. </figcaption>
</figure>
<h1 id="statement-of-need">Statement of need</h1>
<p>For the simulation of random fields, the library <strong>PyAFBF</strong> relies upon the turning-band method developed in <span class="citation" data-cites="Bierme-2015-TBM">[@Bierme-2015-TBM]</span>. This method was historically designed to facilitate researchs on the anisotropic fractional Brownian field <span class="citation" data-cites="Bonami2003">[@Bonami2003]</span> and related models <span class="citation" data-cites="Benassi97 Guyon2000 polisano2014texture Peltier96 Vu2020">[@Benassi97; @Guyon2000; @polisano2014texture; @Peltier96; @Vu2020]</span>. Simulations it generates have been particularly useful to set experimental protocols aiming at assessing performances of estimation methods [<span class="citation" data-cites="Bierme08-ESAIM">@Bierme08-ESAIM</span>; Richard-2010; <span class="citation" data-cites="Richard-2015">@Richard-2015</span>; <span class="citation" data-cites="Richard-2015b">@Richard-2015b</span>; <span class="citation" data-cites="Richard-2016">@Richard-2016</span>; <span class="citation" data-cites="Richard-2017">@Richard-2017</span>]. The estimation issues tackled in these works concerned the functional parameters and features of the AFBF and related models. There are still largely open. The library <strong>PyAFBF</strong> is intended to support future experiments and help mathematicians to validate and compare their methods. In particular, it could be the basis for collaborative works aiming at the development of benchmarks and data challenges.</p>
<p>The simulation of random fields is a classical topic of spatial statistics <span class="citation" data-cites="lantuejoul2013geostatistical cressie2015statistics Chiles-2012">[@lantuejoul2013geostatistical; @cressie2015statistics; @Chiles-2012]</span>. As reviewed in <span class="citation" data-cites="liu2019advances">[@liu2019advances]</span>, there are some R packages devoted to this topic, among which:</p>
<ul>
<li><p><a href="https://cran.r-project.org/web/packages/RandomFields/">RandomFields</a> <span class="citation" data-cites="Schlater-2015">[@Schlater-2015]</span> that enables the simulation of stationary fields and also some non-stationary Gaussian random fields such max-stable fields,</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/FieldSim/FieldSim.pdf">FieldSim</a> <span class="citation" data-cites="brouste2007fractional">[@brouste2007fractional]</span> that allows the simulation of manifold indexed Gaussian field,</p></li>
</ul>
<p>None of these package deals directly with the anisotropic fractional Brownian fields. The package FieldSim deals with mono- and multi- fractional Brownian fields but only in an isotropic setting. The package RandomFields offers a wide range of methods to simulate stationary and non-stationary, isotropic and anisotropic random fields. However, it only handles geometric and zonal anisotropies, which both differ from the one of an AFBF. Moreover, it is not specifically devoted to models derived from the fractional Brownian fields. Hence, the package <strong>PyAFBF</strong> is complementary to these R packages.</p>
<p>The implementation of random field simulation methods in Python are less manifest. It is the purpose of the package <a href="https://github.com/dubourg/python-randomfields">python-randomfields</a> and <a href="https://gitlab.dune-project.org/oklein/dune-randomfield">dune-randomfield</a>. It is also a part of packages <a href="https://ttk.gricad-pages.univ-grenoble-alpes.fr/spam/index.html">spam</a> and <a href="https://hermes.iup.uni-heidelberg.de/dorie_doc/master/html/index.html">dorie</a>. But, none of these package enables the simulation of AFBF. Hence, the package <em>AFBF</em> offers original simulation tools to a large community of Python developers. This is of interest for researchers in image processing where random fields can serve as texture or noise models. This is also of interest for researchers in machine learning where the random field simulation could be included in image generative models such as GAN.</p>
<h1 id="definition-and-simulation-of-an-afbf.">Definition and simulation of an AFBF.</h1>
<p>An AFBF <span class="math inline"><em>Z</em></span> is a Gaussian non-stationary random field with stationary increments whose semi-variograms are of the form</p>
<p><span class="math display"><em>v</em>(<em>h</em>)‚ÄÑ=‚ÄÑ1/2ùîº((<em>Z</em>(<em>x</em>+<em>h</em>)‚àí<em>Z</em>(<em>x</em>))<sup>2</sup>)‚ÄÑ=‚ÄÑ1/2‚à´<sub>‚ÄÖ‚àí‚ÄÖ<em>œÄ</em>/2</sub><sup><em>œÄ</em>/2</sup><em>œÑ</em>(<em>Œ∏</em>)|‚ü®<em>x</em>,<em>u</em><sub><em>Œ∏</em></sub>‚ü©|<sup>2<em>Œ≤</em>(<em>Œ∏</em>)</sup><em>d</em><em>Œ∏</em>,¬†<em>u</em><sub><em>Œ∏</em></sub>‚ÄÑ=‚ÄÑ(cos<em>Œ∏</em>,sin<em>Œ∏</em>),</span></p>
<p>which is characterized by two <span class="math inline"><em>œÄ</em></span>-periodic functions <span class="math inline"><em>œÑ</em></span> and <span class="math inline"><em>Œ≤</em></span> called the topothesy function and the Hurst function, respectively. These functions determined the properties of the AFBF and the aspect of the textures that are sampled from it.</p>
<p>The package <strong>PyAFBF</strong> proposes some convenient representations for these functions (Fourier, step functions,‚Ä¶) that enable to easily set an AFBF, either manually or at random, in a proper way.</p>
<p>Using the package <strong>PyAFBF</strong>, image textures are obtained by simulating realizations of an AFBF on a discrete grid. This is done using a turning band fields. These fields are defined, for some set of angles <span class="math inline">(<em>œÜ</em><sub><em>k</em></sub>,<em>k</em>=1,‚ãØ,<em>K</em>)</span> in <span class="math inline">[‚àí<em>œÄ</em>/2,<em>œÄ</em>/2]</span> and of appropriate non-negative weights <span class="math inline">(<em>Œª</em><sub><em>k</em></sub>,<em>k</em>=1,‚ãØ,<em>K</em>)</span>, as</p>
<p><span class="math display">$$
Z_\varphi (x)  = \sum_{k=1}^K 
$$</span></p>
<p>where <span class="math inline"><em>X</em><sub><em>k</em></sub></span> are independent Brownian motions with Hurst index <span class="math inline"><em>h</em><sub><em>k</em></sub></span>. The package includes a Python class to handle turning-band fields, simulate them and compute their properties.</p>
<h1 id="availability-and-community-guidelines">Availability and Community Guidelines</h1>
<p>The package <strong>PyAFBF</strong> is available at the Gitlab repository. A documentation, which includes a quickstart guide, a gallery of examples and API, can be found at the <a href="">PyAFBF</a> site. Users and contributors are welcome to contribute, request features, and report bugs using a dedicated chat.</p>
<h1 id="references">References</h1>
